name: pivot
description: "Application Laravel Pivot - Plateforme de gestion"

app:
  buildpack: nixpacks
  port: 4004
  domains:
    - host: pivot.guillaume-lcte.fr
      path: /
      port: 4004
      https: true
      certificateType: letsencrypt

  environment:
    # Configuration Laravel
    APP_NAME: "Pivot"
    APP_ENV: production
    APP_KEY: "base64:gmBDzoUYk3CFz7M2ePt3hC+wUyIPvggqmyOd9EZRL94="
    APP_DEBUG: "false"
    APP_URL: "https://pivot.guillaume-lcte.fr"
    ASSET_URL: "https://pivot.guillaume-lcte.fr"
    FORCE_HTTPS: "true"

    # Logs
    LOG_CHANNEL: stack
    LOG_LEVEL: error

    # Base de donn√©es
    DB_CONNECTION: mysql
    DB_HOST: "51.195.43.106"
    DB_PORT: "3306"
    DB_DATABASE: pivot
    DB_USERNAME: pivot
    DB_PASSWORD: pivot

    # Cache et sessions
    CACHE_DRIVER: file
    SESSION_DRIVER: file
    SESSION_LIFETIME: "120"
    SESSION_SECURE_COOKIE: "true"
    SESSION_SAME_SITE: lax
    SESSION_DOMAIN: ".guillaume-lcte.fr"

    # Queue
    QUEUE_CONNECTION: sync

    # Mail
    MAIL_MAILER: smtp
    MAIL_HOST: "51.195.43.106"
    MAIL_PORT: "1025"
    MAIL_FROM_ADDRESS: "noreply@guillaume-lcte.fr"
    MAIL_FROM_NAME: "Pivot"

    # Vite
    VITE_APP_NAME: "Pivot"
    VITE_APP_URL: "https://pivot.guillaume-lcte.fr"

  # Build configuration
  buildArgs:
    - NODE_ENV=production

  # Health check
  healthCheck:
    path: /health
    interval: 30s
    timeout: 10s
    retries: 3

  # Resource limits
  resources:
    memory: 512Mi
    cpu: 0.5 